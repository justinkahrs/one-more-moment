---
import { Image } from "astro:assets";
// Import all images from the sponsors directory
const sponsors = import.meta.glob<{ default: ImageMetadata }>(
  "../assets/sponsors/*.{jpeg,jpg,png,gif,svg}",
  { eager: true },
);
const sponsorItems = Object.entries(sponsors).map(([path, mod]) => {
  const file = path.split("/").pop() ?? path;
  const name = file.replace(/\.[^/.]+$/, "");
  return { img: mod.default, name };
});
---

<div class="bg-base-100 w-full overflow-hidden py-12">
  <div class="relative w-full max-w-[100vw]">
    <div class="animate-marquee flex w-max items-center gap-12">
      {/* First set of images */}
      {
        sponsorItems.map((item) => (
          <div class="group relative flex h-[80px] w-[150px] items-center justify-center">
            <Image
              src={item.img}
              alt={item.name}
              title={item.name}
              class="max-h-full max-w-full object-contain opacity-70 grayscale transition-all duration-300 group-hover:scale-130 group-hover:opacity-100 group-hover:grayscale-0"
            />
          </div>
        ))
      }
      {/* Duplicate set for seamless looping */}
      {
        sponsorItems.map((item) => (
          <div class="group relative flex h-[80px] w-[150px] items-center justify-center">
            <Image
              src={item.img}
              alt={item.name}
              title={item.name}
              class="max-h-full max-w-full object-contain opacity-70 grayscale transition-all duration-300 group-hover:scale-130 group-hover:opacity-100 group-hover:grayscale-0"
            />
          </div>
        ))
      }
      {/* Duplicate set for seamless looping (extra safety for wide screens) */}
      {
        sponsorItems.map((item) => (
          <div class="group relative flex h-[80px] w-[150px] items-center justify-center">
            <Image
              src={item.img}
              alt={item.name}
              title={item.name}
              class="max-h-full max-w-full object-contain opacity-70 grayscale transition-all duration-300 group-hover:scale-130 group-hover:opacity-100 group-hover:grayscale-0"
            />
          </div>
        ))
      }
    </div>
  </div>
</div>

<style>
  @keyframes marquee {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-33.33%);
    }
  }
  .animate-marquee {
    animation: marquee 30s linear infinite;
  }
  /* Pause animation on hover */
  .animate-marquee:hover {
    animation-play-state: paused;
  }
</style>
